These codes are written in scala and should be executed in spark-shell line by line
